<!DOCTYPE html><html><head>    <meta charset="utf-8" />    <title>云老虎服务商平台</title>    <meta name="keywords" content="" />    <meta name="description" content="" />    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />    <link rel="icon" href="/icon.ico">    <link href="__PUBLIC__/assets/css/bootstrap.min.css" rel="stylesheet" />    <link rel="stylesheet" href="__PUBLIC__/assets/css/font-awesome.min.css" />    <link rel="stylesheet" href="__PUBLIC__/assets/css/ace.min.css" />    <link rel="stylesheet" href="__PUBLIC__/assets/css/shanghu.css" />    <link rel="stylesheet" href="__PUBLIC__/assets/css/pageGroup.css" />    <link rel="stylesheet" href="__PUBLIC__/assets/css/bootstrap-datetimepicker.min.css" />    <!--[if IE 7]>    <link rel="stylesheet" href="__PUBLIC__/assets/css/font-awesome-ie7.min.css" />    <![endif]-->    <!--[if lte IE 8]>    <link rel="stylesheet" href="__PUBLIC__/assets/css/ace-ie.min.css" />    <![endif]-->    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->    <!--[if lt IE 9]>    <script src="__PUBLIC__/assets/js/html5shiv.js"></script>    <script src="__PUBLIC__/assets/js/respond.min.js"></script>    <![endif]--></head><body><div class="navbar navbar-default" id="navbar">    <script type="text/javascript">        try {            ace.settings.check( 'navbar','fixed' )        } catch ( e ) {        }    </script>    <!--head_start-->    <div class="navbar-container" id="navbar-container">        <div class="navbar-header pull-left">            <a href="__APP__" class="navbar-brand">                <small> <i class="icon-leaf"></i>                    翼慧支付平台                </small>            </a>        </div>    </div></div><form class="form-horizontal" id="validation-form" method="post" >    <div class="main-content" style="margin-left:0 !important">        <div class="page-content">            <div class="page-header">                <h1>二维码注册</h1>            </div>            <div class="row">                <div class="col-xs-12">                    <div class="row-fluid">                        <div class="span12">                            <div class="widget-box">                                <div class="widget-header widget-header-blue widget-header-flat">                                    <h4 class="lighter">商户申请</h4>                                </div>                                <div class="widget-body">                                    <div class="widget-main">                                        <div class="step-content row-fluid position-relative" id="step-container">                                            <div class="step-pane active" id="step1">                                                <div class="row">                                                    <div class="col-md-4">                                                        <div class="form-group">                                                            <div class="col-xs-12 mr_mab">                                                                <label>商户账号（管理员）</label>                                                                <div class="over">                                                                    <input type="text" class="form-control" name="sh_yhm" id="sh_yhm" placeholder="商户账号" />                                                                </div>                                                            </div>                                                        </div>                                                    </div>                                                    <div class="col-md-4">                                                        <div class="form-group">                                                            <div class="col-xs-12 mr_mab">                                                                <label>店铺名称</label>                                                                <div class="over">                                                                    <input type="text" class="form-control" name="sh_mdmc" id="sh_mdmc" placeholder="店铺名称" />                                                                </div>                                                            </div>                                                        </div>                                                    </div>                                                    <div class="col-md-4">                                                        <div class="form-group">                                                            <div class="col-xs-12 mr_mab">                                                                <label>子商户号</label>                                                                <div class="over">                                                                    <input type="text" class="form-control" name="sub_mch_id" style="color: #999 !important;" id="sub_mch_id" placeholder="子商户号"/>                                                                </div>                                                            </div>                                                        </div>                                                    </div>                                                    <div class="clearfix"></div>                                                    <div class="col-md-4">                                                        <div class="form-group">                                                            <div class="col-xs-12 mr_mab">                                                                <label>收银员账号</label>                                                                <div class="over">                                                                    <input type="text" class="form-control" name="sx_dlm" id="sx_dlm" placeholder="收银员账号" />                                                                </div>                                                            </div>                                                        </div>                                                    </div>                                                    <div class="col-md-4">                                                        <div class="form-group">                                                            <div class="col-xs-12 mr_mab">                                                                <label>密码</label>                                                                <div class="input-group">                                                                    <input type="text" class="form-control random_pass" name="sx_pass" id="sx_pass" placeholder="密码" />                                                                    <span class="input-group-btn">                                                                        <button class="btn btn-success click_pass" type="button">                                                                            <i class="icon-key"></i>                                                                            生成密码                                                                        </button>                                                                    </span>                                                                </div>                                                            </div>                                                        </div>                                                    </div>                                                    <div class="col-md-4">                                                        <div class="form-group">                                                            <div class="col-xs-12 mr_mab">                                                                <label>收银员姓名</label>                                                                <div class="over">                                                                    <input type="text" class="form-control" name="sx_name" id="sx_name" placeholder="收银员姓名" />                                                                </div>                                                            </div>                                                        </div>                                                    </div>                                                    <div class="clearfix"></div>                                                    <div class="col-md-4 col-xs-4">                                                        <div class="form-group">                                                            <div class="col-xs-12 mr_mab">                                                                <label>店铺区域</label>                                                                <div class="over">                                                                    <select class="form-control" id="provinces" name="provinces">                                                                        <option value="">选择省份</option>                                                                    </select>                                                                </div>                                                            </div>                                                        </div>                                                    </div>                                                    <div class="col-md-4 col-xs-4">                                                        <div class="form-group">                                                            <div class="col-xs-12 mr_mab">                                                                <label>&emsp;</label>                                                                <div class="over">                                                                    <select class="form-control" id="citys" name="citys">                                                                        <option value="">市</option>                                                                    </select>                                                                </div>                                                            </div>                                                        </div>                                                    </div>                                                    <div class="col-md-4 col-xs-4">                                                        <div class="form-group">                                                            <div class="col-xs-12 mr_mab">                                                                <label>&emsp;</label>                                                                <div class="over">                                                                    <select class="form-control" id="countys" name="countys">                                                                        <option value="">区</option>                                                                    </select>                                                                </div>                                                            </div>                                                        </div>                                                    </div>                                                    <div class="clearfix"></div>                                                    <div class="col-md-4">                                                        <div class="form-group">                                                            <div class="col-xs-12 mr_mab">                                                                <label>店铺详细地址</label>                                                                <div class="over">                                                                    <input type="text" class="form-control" name="detailaddress" id="detailaddress" placeholder="店铺详细地址" />                                                                </div>                                                            </div>                                                        </div>                                                    </div>                                                    <div class="clearfix"></div>                                                    <div class="clearfix"></div>                                                </div>                                                <div class="clearfix"></div>                                            </div>                                        </div>                                    </div>                                </div>                            </div>                        </div>                    </div>                </div>            </div>            <div class="row">                <div class="col-xs-12">                    <div class="row-fluid">                        <div class="span12">                            <div class="widget-box">                                <div class="widget-header widget-header-blue widget-header-flat">                                    <h4 class="lighter">结算卡信息</h4>                                </div>                                <div class="widget-body">                                    <div class="widget-main">                                        <div class="step-content row-fluid position-relative">                                            <div class="step-pane active">                                                <div class="row">                                                    <div class="clearfix"></div>                                                    <div class="col-md-4">                                                        <div class="form-group">                                                            <div class="col-xs-12 mr_mab">                                                                <label>姓名</label>                                                                <div class="over">                                                                    <input type="text" class="form-control" name="sx_khxm" id="sx_khxm" placeholder="收款人姓名" value=""/>                                                                </div>                                                            </div>                                                        </div>                                                    </div>                                                    <div class="col-md-4">                                                        <div class="form-group">                                                            <div class="col-xs-12 mr_mab">                                                                <label>银行</label>                                                                <div class="over">                                                                    <select  name="sx_khhmc" id="sx_khhmc" class="form-control">                                                                        <option value="">请选择银行</option>                                                                    </select>                                                                </div>                                                            </div>                                                        </div>                                                    </div>                                                    <div class="col-md-4">                                                        <div class="form-group">                                                            <div class="col-xs-12 mr_mab">                                                                <label>支行关键字</label>                                                                <div class="input-group">                                                                    <input type="text" class="form-control"  id="sx_khhh" placeholder="请填定支行关键字搜索" value=""/>                                                                    <span class="input-group-btn">                                                                            <button class="btn btn-info" type="button" id = "search">                                                                                <i class="glyphicon glyphicon-search"></i>                                                                                搜索                                                                            </button>                                                                        </span>                                                                </div>                                                                <label style="color:#ff0000;display:none;" id ="Bank_Error">*银行和关键字不能为空</label>                                                                <div style="padding: 5px 0; text-align: center;display:none" id = "Loading"><img src="__PUBLIC__/assets/images/ico_loading.gif" alt=""></div>                                                                <div  style="display:none" class="subbranch">                                                                    <div class="clearfix"></div>                                                                    <label>选择支行</label>                                                                    <select name="OpenBank" id = 'OpenBank' class="form-control">                                                                        <option value="">请选择开户支行</option>                                                                    </select>                                                                </div>                                                            </div>                                                        </div>                                                    </div>                                                    <div class="clearfix"></div>                                                    <div class="col-md-4">                                                        <div class="form-group">                                                            <div class="col-xs-12 mr_mab">                                                                <label>银行卡号</label>                                                                <div class="over">                                                                    <input type="text" class="form-control" name="sx_yhkh" id="sx_yhkh" placeholder="银行卡号" value=""/>                                                                </div>                                                            </div>                                                        </div>                                                    </div>                                                </div>                                                <div class="clearfix"></div>                                                <input type= "hidden" value = "" id ="codesysno" name = "codesysno">                                                <div class="form-group">                                                    <div class="col-xs-12">                                                        <button type="submit" class="btn btn-primary">                                                            <i class="icon-ok bigger-110"></i>                                                            确认创建                                                        </button>                                                    </div>                                                </div>                                            </div>                                        </div>                                    </div>                                </div>                            </div></form></div></div></div></div></div></div></div></div><include file="Base:jsfile"/><script type="text/javascript">    var codesysno = GetQueryString ("CodeSysNo");    var Cs = parseInt(codesysno);    $("#codesysno").val(Cs);    var topid = GetQueryString ("Topid");    var Ti = parseInt(topid);    jQuery( function ( $ ){        $( '#validation-form' ).validate( {            errorElement : 'div',            errorClass : 'help-block',            focusInvalid : false,            rules : {                sh_yhm : {                    required : true,                    mobile : true                },                sh_pass : {                    required : true,                    appid:true                },                sh_mdmc : {                    required : true,                },                sx_dlm : {                    required : true,                    username:true                },                sx_pass : {                    required : true,                    appid:true                },                sx_name : {                    required : true,                    chinese:true                },                email : {                    required : true,                    email : true                },                store_id : {                    num : true                },                provinces:{                    required:true                },                citys:{                    required:true                },                countys:{                    required:true                },                detailaddress:{                    required:true                },                sx_khhmc:{                    required:true                },                sx_yhkh:{                    required:true,                    num : true                },                sx_khxm:{                    required:true                },                OpenBank:{                    required:true                },                sub_mch_id:{                    required:true,                    tennum:true                }            },            messages : {                sh_yhm : {                    required : "商户账号不能为空!",                    mobile : "商户账号为手机号,请填写正确的手机号!"                },                sh_pass : {                    required : "密码不能为空!"                },                sh_mdmc : {                    required : "店铺名称不能为空!",                },                sx_dlm : {                    required : "收银员账号不能为空!.",                    username:"请输入正确的收银员账号!"                },                sx_pass : {                    required : "密码不能为空."                },                sx_name : {                    required : "收银员姓名不能为空!",                    chinese:"输入正确的收银员姓名!"                },                email : {                    required : "邮箱不能为空!",                    email : "请输入正确的邮箱!"                },                provinces:{                    required: "请选择省级",                },                citys:{                    required: "请选择市级",                },                countys:{                    required: "请选择区级",                },                detailaddress:{                    required: "请填写详细地址",                },                store_id : {                    num : "门店ID为数字!"                },                sx_khhmc:{                    required: "开户行名称不能为空!",                },                sx_yhkh:{                    required: "银行卡号不能为空!",                    num : "银行卡号只能为数字!"                },                sx_khxm:{                    required: "收款人姓名不能为空!",                    chinese:"输入正确的收款人姓名!"                },                OpenBank:{                    required: "支行不能为空!",                },                sub_mch_id:{                    required:"子商户ID不能为空!",                    tennum:"子商户ID为10位数字!"                },                subscription : "Please choose at least one option",                gender : "Please choose gender",                agree : "Please accept our policy"            },            invalidHandler : function ( event,                                        validator ){ //display error alert on form submit                $( '.alert-danger',$( '.login-form' ) ).                show();            },            highlight : function ( e ){                $( e ).closest( '.form-group' ).                removeClass( 'has-info' ).addClass(                    'has-error' );            },            success : function ( e ){                $( e ).closest( '.form-group' ).                removeClass( 'has-error' ).addClass(                    'has-info' );                $( e ).remove();            },            errorPlacement : function ( error,element ){                if ( element.is( ':checkbox' ) ||                    element.is( ':radio' ) ) {                    var controls = element.closest(                        'div[class*="col-"]' );                    if ( controls.find(                            ':checkbox,:radio' ).length > 1 )                        controls.append(                            error );                    else                        error.insertAfter(                            element.nextAll(                                '.lbl:eq(0)' ).                            eq(                                0 ) );                }                else if ( element.is( '.select2' ) ) {                    error.insertAfter( element.siblings(                        '[class*="select2-container"]:eq(0)' ) );                }                else if ( element.is(                        '.chosen-select' ) ) {                    error.insertAfter( element.siblings(                        '[class*="chosen-container"]:eq(0)' ) );                }                else                    error.insertAfter(                        element.parent() );            },            submitHandler : function ( form ){                $.ajax( {                    type : "POST",                    url : "__APP__/QRCodeList/qrcode_register",                    data : {                        codesysno:$( "#codesysno" ).val(),                        sh_yhm : $( "#sh_yhm" ).val(),                        sh_pass : $( "#sh_pass" ).val(),                        sh_mdmc : $( "#sh_mdmc" ).val(),                        sh_staffid : Ti,                        sx_dlm : $( "#sx_dlm" ).val(),                        sx_pass : $("#sx_pass" ).val(),                        sx_name : $( "#sx_name" ).val(),                        AddressNum : $("#provinces").val()+'|'+$("#citys").val()+'|'+$("#countys").val(),                        address : $("#provinces  option:selected").text()+$("#citys  option:selected").text()+$("#countys  option:selected").text()+'-'+$("#detailaddress").val(),                        sx_khhmc : $("#OpenBank  option:selected").text(),                        sx_khhh : $( "#OpenBank" ).val(),                        sx_yhkh : $( "#sx_yhkh" ).val(),                        sx_khxm : $( "#sx_khxm" ).val(),                        sx_skrzhlx : $( "#sx_skrzhlx" ).val(),                        sub_mch_id:$("#sub_mch_id").val()                    },                    async:false,                    success : function ( data ){                        if ( data.Code == 0 ) {                            alert('注册成功！');                            location.href = "http://web.yunlaohu.cn/index.php/Wxpay/newpay/?systemUserSysNo="+data.SysNo;                            $('#validation-form')[0].reset();                        }                        if (data.Code!=0){                            if (data.Result==1) {                                alert("数据异常！");                            }                            if (data.Result==2) {                                alert("商户重复！");                            }                            if (data.Result==3) {                                alert("员工重复！");                            }                        }                    }                } )            },            invalidHandler: function ( form ){                console.log( "ajax失败！" );            }        } );    } )</script><script language="Javascript">    $( function (){        $( ".click_pass" ).click( function (){            var x = 1000000;            var y = 1;            var random = String.fromCharCode( Math.floor( Math.random() *                        26 ) + "a".charCodeAt( 0 ) ).toUpperCase() + parseInt(                    Math.random() * ( x - y + 1 ) + y ) + String.fromCharCode(                    Math.floor( Math.random() * 26 ) + "a".charCodeAt( 0 ) );            $( ".random_pass" ).val( random );        } );        // $( ".click_shpass" ).click( function (){        //     var x = 1000000;        //     var y = 1;        //     var random = String.fromCharCode( Math.floor( Math.random() *        //         26 ) + "a".charCodeAt( 0 ) ).toUpperCase() + parseInt(        //         Math.random() * ( x - y + 1 ) + y ) + String.fromCharCode(        //         Math.floor( Math.random() * 26 ) + "a".charCodeAt( 0 ) );        //     $( ".random_shpass" ).val( random );        // } );    } )</script><script type="text/javascript">    $(document).ready(function() {        $.ajax({            type : "post",            url: "__APP__/QRCodeList/getbanklist",            data: {},            success: function(data) {                $.each(data, function(i, v) {//sx_khhmc                    $("#sx_khhmc").append("<option value='" + v.Bank_No + "'>" + v.Bank_Name + "</option>");                });            }        });        //  加载所有的省份        $.ajax({            type : "post",            url: "__APP__/Lian/GetAddress", // type=1表示查询省份            data: {"type": "1"},            success: function(data) {//                            $("#provinces").html("<option value=1>北京市</option>");                  $("#provinces").html("<option value=''>省份</option>");                $.each(data, function(i, item) {                    $("#provinces").append("<option value='" + item.region_id + "'>" + item.region_name + "</option>");                });                $("#provinces option").each(function() {                    var val = $(this).val();                    if ( $("#provinces option[value='" + val + "']").length > 1 )                        $("#provinces option[value='" + val + "']:gt(0)").remove();                });            }        });        $("#provinces").change(function() {            $.ajax({                type : "post",                url: "__APP__/Lian/GetAddress", // type =2表示查询市                data: {"parent_id": $(this).val(), "type": "2"},                success: function(data) {                    $("#citys").html("<option value=''>市</option>");                    $("#countys").html("<option value=''>区</option>");                    $.each(data, function(i, item) {                        $("#citys").append("<option value='" + item.region_id + "'>" + item.region_name + "</option>");                    });                }            });        });        $("#citys").change(function() {            $.ajax({                type : "post",                url: "__APP__/Lian/GetAddress", // type =2表示查询市                data: {"parent_id": $(this).val(), "type": "3"},                success: function(data) {                    $("#countys").html("<option value=''>选择区</option>");                    $.each(data, function(i, item) {                        $("#countys").append("<option value='" + item.region_id + "'>" + item.region_name + "</option>");                    });                }            });            $("#countys").change(function() {//			alert($("#countys").val());////					alert($(this).val());//			console.log($("#citys  option:selected").text()+"-"+$("#countys").val());            });        });        $("#search").click(function(){            var Bank_Key=$("#sx_khhh").val();            var Bank_No =$("#sx_khhmc").val();            if(Bank_Key==''||Bank_No==''){                $("#Bank_Error").show();                return false;            }            $("#Loading").show();            $("#Bank_Error").hide();            $.ajax({                type : "post",                url: "__APP__/QRCodeList/searchbank", // type =2表示查询市                data: {                    "Bank_No": Bank_No,                    "Bank_Key": Bank_Key                },                success: function(data) {                    $("#Loading").hide();                    if(data){                        $(".subbranch").slideDown();                        $.each(data, function(i, item) {                            $("#OpenBank").empty();                            $("#OpenBank").append("<option value='" + item.Total_Bank + "'>" + item.Bank_Name + "</option>");                        });                    }else{                        $("#Bank_Error").show().html("查询不到数据,请重新查询");                        $(".subbranch").hide();                    }                }            });        });    });</script><include file="Base:footer"/>